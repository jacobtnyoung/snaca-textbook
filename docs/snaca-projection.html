<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jacob T.N. Young">

<title>Projection – Social Network Analysis for Crime Analysts</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./snaca-bipartite.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-b53751a350365c71b6c909e95f209ed1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-4f9b853ce4cffb63a45f69a2d6d81c11.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./snaca-projection.html">Projection</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Social Network Analysis for Crime Analysts</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/jacobtnyoung/snaca-textbook" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./snaca-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Social Network Analysis for Crime Analysts</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./snaca-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Network Theory and Theory of Networks</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./snaca-methods.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Network Data Collection</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./snaca-net-data-structures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Network Data Structures</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./snaca-net-description.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Network Description</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./snaca-centrality-degree.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Degree Centrality</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./snaca-centrality-closeness.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Closeness Centrality</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./snaca-centrality-betweenness.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Betweenness Centrality</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./snaca-bipartite.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bipartite Graphs/Two-Mode Networks</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./snaca-projection.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Projection</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#case-study-body-worn-cameras-police-officer-perceptions-and-shared-incident-networks-revisited" id="toc-case-study-body-worn-cameras-police-officer-perceptions-and-shared-incident-networks-revisited" class="nav-link active" data-scroll-target="#case-study-body-worn-cameras-police-officer-perceptions-and-shared-incident-networks-revisited">Case Study: Body-Worn Cameras, Police Officer Perceptions, and Shared-Incident Networks (revisited)</a></li>
  <li><a href="#projection-terminology-and-conceptual-aspects" id="toc-projection-terminology-and-conceptual-aspects" class="nav-link" data-scroll-target="#projection-terminology-and-conceptual-aspects">Projection: Terminology and Conceptual Aspects</a></li>
  <li><a href="#building-the-projection" id="toc-building-the-projection" class="nav-link" data-scroll-target="#building-the-projection">Building the Projection</a>
  <ul class="collapse">
  <li><a href="#matrix-multiplication-rules" id="toc-matrix-multiplication-rules" class="nav-link" data-scroll-target="#matrix-multiplication-rules">Matrix Multiplication Rules</a></li>
  <li><a href="#people-matrix" id="toc-people-matrix" class="nav-link" data-scroll-target="#people-matrix">“People” Matrix</a></li>
  <li><a href="#group-matrix" id="toc-group-matrix" class="nav-link" data-scroll-target="#group-matrix">“Group” Matrix</a></li>
  </ul></li>
  <li><a href="#dichotomization-and-summation" id="toc-dichotomization-and-summation" class="nav-link" data-scroll-target="#dichotomization-and-summation">Dichotomization and Summation</a>
  <ul class="collapse">
  <li><a href="#dichotomization" id="toc-dichotomization" class="nav-link" data-scroll-target="#dichotomization">Dichotomization</a></li>
  <li><a href="#summation" id="toc-summation" class="nav-link" data-scroll-target="#summation">Summation</a></li>
  </ul></li>
  <li><a href="#test-your-knowledge" id="toc-test-your-knowledge" class="nav-link" data-scroll-target="#test-your-knowledge">Test your Knowledge</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jacobtnyoung/snaca-textbook/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Projection</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In the prior chapter on <a href="snaca-bipartite.html">Bipartite Graphs/Two-Mode Networks</a>, we saw that not all of the networks we want to examine have a single node set. We discussed how complex relational structures with multiple partitions of node sets can be examined using <strong>bipartite</strong> graphs.</p>
<section id="case-study-body-worn-cameras-police-officer-perceptions-and-shared-incident-networks-revisited" class="level2">
<h2 class="anchored" data-anchor-id="case-study-body-worn-cameras-police-officer-perceptions-and-shared-incident-networks-revisited">Case Study: Body-Worn Cameras, Police Officer Perceptions, and Shared-Incident Networks (revisited)</h2>
<p>Let’s revisit the study by <span class="citation" data-cites="young2015">Young and Ready (<a href="references.html#ref-young2015" role="doc-biblioref">2015</a>)</span> discussed in the previous chapter. Recall that the researchers sought to examine two research questions:</p>
<ul>
<li>How do police officers “frame” body-worn cameras?</li>
<li>Is the meaning officers attribute to cameras created and transmitted in groups?</li>
</ul>
<p>To answer these questions, <span class="citation" data-cites="young2015">Young and Ready (<a href="references.html#ref-young2015" role="doc-biblioref">2015</a>)</span> studied the two-mode network of shared incidents between police officers:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/young-ready-bipartite-figure.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>To study how police officers’ views of body cameras were influenced by those with whom they shared incidents, <span class="citation" data-cites="young2015">Young and Ready (<a href="references.html#ref-young2015" role="doc-biblioref">2015</a>)</span> <em>actually</em> examined this network:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/young-ready-projection-figure.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>In this network, the nodes are police officers and the edges represent shared incidents. The width of the edges represents the number of shared incidents in that wider edges between two nodes mean that more incidents were shared between those nodes. So if two officers have a thick edge connecting them, it means that they were present at multiple incidents at the same time. This network is the “weighted, unipartite projection” of the bipartite graph.</p>
<p><em>Where did this graph come from?</em> It was created through a process called <strong>projection</strong>. In this chapter you will learn how to project two-mode graphs to one-mode graphs. By the end of this chapter, you should be able to:</p>
<ul>
<li>Describe how to create a unipartite graph from a bipartite graph.</li>
<li>Explain the difference between <em>dichotomized</em> projections and <em>summation</em> projections.</li>
</ul>
</section>
<section id="projection-terminology-and-conceptual-aspects" class="level2">
<h2 class="anchored" data-anchor-id="projection-terminology-and-conceptual-aspects">Projection: Terminology and Conceptual Aspects</h2>
<p>Bipartite networks can be represented using an adjacency matrix where the rows and columns correspond to the separate sets of nodes <span class="math inline">\(N\)</span> and <span class="math inline">\(M\)</span>, respectively. While the <a href="snaca-bipartite.html">Bipartite Graphs/Two-Mode Networks</a> chapter discussed ways to examine such an adjacency matrix, a very common approach in research is to reduce the bipartite graph to a unipartite graph. This is done for several reasons, but the main reason is that there are more analytic tools available for examining a single set of nodes. <strong>Projection</strong> is the process by which we map the connectivity between modes to a single mode.</p>
<p>For example, let’s say we have a two-mode network of people (<span class="math inline">\(N\)</span>) in groups (<span class="math inline">\(M\)</span>). By projecting, we get either:</p>
<ul>
<li>A one-mode network of people connected to people by groups (an <span class="math inline">\(N \times N\)</span> adjacency matrix) and/or</li>
<li>A one-mode network of groups connected by people (an <span class="math inline">\(M \times M\)</span> adjacency matrix).</li>
</ul>
<p>We can see this graphically by taking a look at our example network from the <a href="snaca-bipartite.html">Bipartite Graphs/Two-Mode Networks</a> chapter:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/ch-10-graph-01.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>Consider nodes <em>A</em>, <em>B</em>, and <em>C</em>. Are they connected?</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/ch-11-figure-02.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>We can see that <em>A</em>, <em>B</em>, and <em>C</em> are connected through the shared edges with node <em>1</em>. That is, the edges <span class="math inline">\(L_{A,1}\)</span> and <span class="math inline">\(L_{B,1}\)</span> connect nodes <em>A</em> and <em>B</em>. The same for edges <span class="math inline">\(L_{B,1}\)</span> and <span class="math inline">\(L_{C,1}\)</span> which connect nodes <em>B</em> and <em>C</em>.</p>
<p>What about node <em>2</em> ?</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/ch-11-figure-03.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>We can see that <em>A</em>, <em>C</em>, and <em>D</em> are connected through the shared edges with node <em>2</em>. That is, the edges <span class="math inline">\(L_{A,2}\)</span> and <span class="math inline">\(L_{C,2}\)</span> connect nodes <em>A</em> and <em>C</em> and edges <span class="math inline">\(L_{C,2}\)</span> and <span class="math inline">\(L_{D,2}\)</span> connect nodes <em>C</em> and <em>D</em>.</p>
<p>These connections are what the projection to the <span class="math inline">\(N\)</span> node set will render in the unipartite graph.</p>
<p>What about the <span class="math inline">\(M\)</span> nodes?</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/ch-11-figure-04.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>We can see that <em>2</em>, <em>3</em>, <em>4</em>, and <em>5</em> are connected through the shared edges with node <em>D</em>. That is, the edges <span class="math inline">\(L_{D,2}\)</span> and <span class="math inline">\(L_{D,3}\)</span> connect nodes <em>2</em> and <em>3</em> and edges <span class="math inline">\(L_{D,4}\)</span> and <span class="math inline">\(L_{D,5}\)</span> connect nodes <em>4</em> and <em>5</em>.</p>
<p>Note that nodes in one node set can be connected through multiple nodes in the alternative node set. For example:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/ch-11-figure-05.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>That is, the edges <span class="math inline">\(L_{D,3}\)</span> and <span class="math inline">\(L_{D,5}\)</span> connect nodes <em>3</em> and <em>5</em>. But, nodes <em>3</em> and <em>5</em> are also connected by edges <span class="math inline">\(L_{F,3}\)</span> and <span class="math inline">\(L_{F,5}\)</span> (highlighted in the figure).</p>
</section>
<section id="building-the-projection" class="level2">
<h2 class="anchored" data-anchor-id="building-the-projection">Building the Projection</h2>
<p>In an influential paper titled <em>The Duality of Persons and Groups</em>, <span class="citation" data-cites="breiger1974duality">Breiger (<a href="references.html#ref-breiger1974duality" role="doc-biblioref">1974</a>)</span> proved mathematically that we can build the adjacency matrix for each projected network through matrix algebra. (YAY!). If you are unfamiliar with matrix algebra, that is fine. It is simply using mathematical expressions on matrices (e.g.&nbsp;adding two matrices, or multiplying two matrices). Since the bipartite graph represents two nodes sets, we can create two unipartite graphs: a “people” network and a “group” network. The “people” network is the connections between the <span class="math inline">\(N\)</span> nodes and the “group” network is the connections between the <span class="math inline">\(M\)</span> nodes.</p>
<p>Let’s make this more concrete. We create these projections by multiplying an adjacency matrix by it’s <em>transpose</em>. The <u>transpose</u> of a matrix simply reverses the columns and rows:</p>
<p><span class="math display">\[A^T_{ij} = A_{ji}\]</span></p>
<p>Here, the <span class="math inline">\(T\)</span> in the superscript is used to indicate the <em>transpose</em> of the matrix <span class="math inline">\(A\)</span>. Note that all we do is switch the columns and rows.</p>
<p>A two-mode <span class="math inline">\(N \times M\)</span> adjacency matrix, can be projected to:</p>
<ul>
<li>A <span class="math inline">\(M \times M\)</span> matrix (ties among <span class="math inline">\(M\)</span> nodes via <span class="math inline">\(N\)</span>) and/or</li>
<li>A <span class="math inline">\(N \times N\)</span> matrix (ties among <span class="math inline">\(N\)</span> nodes via <span class="math inline">\(M\)</span>)</li>
</ul>
<p>Let’s take our example network above and look at this a bit closer:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/ch-10-graph-02.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>Note that our matrix, <span class="math inline">\(A\)</span>, has 6 rows and 5 columns. This means it has <em>order</em> <span class="math inline">\(6 \times 5\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/ch-11-figure-06.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>Recall, that the transpose of a matrix simply reverses the columns and rows. To get the transpose, imagine rotating the matrix 90 degrees, and then flipping it over. That would give us this:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/ch-11-figure-07.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>In the transpose, <span class="math inline">\(A^T\)</span>, the rows and columns have been switched. We now have 5 rows and 6 columns. This means it has <em>order</em> <span class="math inline">\(5 \times 6\)</span>.</p>
<p><em>So what?</em></p>
<p>We need to briefly review some rules about matrix multiplication to understand why the emphasis on order is important.</p>
<section id="matrix-multiplication-rules" class="level3">
<h3 class="anchored" data-anchor-id="matrix-multiplication-rules">Matrix Multiplication Rules</h3>
<p>To multiply two matrices, the number of columns in the first matrix must match the number of rows in the second matrix. For example:</p>
<ul>
<li><span class="math inline">\(5 \times 6\)</span> X <span class="math inline">\(6 \times 5\)</span> works,</li>
<li>but <span class="math inline">\(5 \times 6\)</span> X <span class="math inline">\(5 \times 6\)</span> does not work.</li>
</ul>
<p>The rule is that the “inner numbers must match”, meaning that the two inside numbers (the number of columns in the first matrix and the number of rows in the second matrix) must be the same.</p>
<section id="product-matrix" class="level4">
<h4 class="anchored" data-anchor-id="product-matrix">Product Matrix</h4>
<p>When we multiply two matrices, we get the <strong>product matrix</strong>. The product matrix has the number of rows equal to the first matrix and the number of columns equal to the second matrix. For example: <span class="math inline">\(5 \times 6\)</span> X <span class="math inline">\(6 \times 5\)</span> = <span class="math inline">\(5 \times 5\)</span>.</p>
<p>The product matrix is the projected graph. Recall that there are two potential product matrices we can create:</p>
<ul>
<li><span class="math inline">\(A \times A^T\)</span> (what <span class="citation" data-cites="breiger1974duality">Breiger (<a href="references.html#ref-breiger1974duality" role="doc-biblioref">1974</a>)</span> called the “people” matrix, <span class="math inline">\(P\)</span>) and</li>
<li>The <span class="math inline">\(A^T \times A\)</span> (what <span class="citation" data-cites="breiger1974duality">Breiger (<a href="references.html#ref-breiger1974duality" role="doc-biblioref">1974</a>)</span> called the “group” matrix <span class="math inline">\(G\)</span>)</li>
</ul>
<p><em>What does each one represent?</em></p>
<p>To answer this question, let’s work on creating the projections!</p>
</section>
</section>
<section id="people-matrix" class="level3">
<h3 class="anchored" data-anchor-id="people-matrix">“People” Matrix</h3>
<p>To create the “people” matrix, <span class="math inline">\(P\)</span>, which connects nodes in the the set <span class="math inline">\(N\)</span>, we perform the following matrix multiplication for our adjacency matrix <span class="math inline">\(A\)</span>:</p>
<p><span class="math display">\[A \times A^T = P\]</span> Let’s see how this works by visualizing our example:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/ch-11-figure-08.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>After multiplication we get:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/ch-11-figure-09.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>The product matrix as rows <span class="math inline">\(N \times N\)</span> shows us how people are connected by groups.</p>
<p>The values of the matrix show two important things:</p>
<ul>
<li>The diagonal cells represents the count of ties that a specific node in <span class="math inline">\(N\)</span> has with nodes in <span class="math inline">\(M\)</span></li>
<li>The off-diagonal cells count the number of ways that separate nodes in <span class="math inline">\(N\)</span> are connected by nodes in <span class="math inline">\(M\)</span></li>
</ul>
<p>Let’s take a look at each of these points.</p>
<section id="diagonal-cells" class="level4">
<h4 class="anchored" data-anchor-id="diagonal-cells">Diagonal Cells</h4>
<p>The diagonal tells us the count of ties that a specific node in <span class="math inline">\(N\)</span> has with nodes in <span class="math inline">\(M\)</span>. Using the language of “groups” to refer to the <span class="math inline">\(M\)</span> node set, the diagonal is the count of groups to which a node in <span class="math inline">\(N\)</span> is connected.</p>
<p>For example, in the figure below, <em>D</em> is in 4 groups:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/ch-11-figure-10.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>We can see this in the graph by counting the edges, but also by looking at the <span class="math inline">\(P_{D,D}\)</span> cell of the adjacency matrix <span class="math inline">\(P\)</span> (highlighted in red).</p>
<p>Here is a question. <em>What network measure does the diagonal give us?</em> Think back to the chapter on <a href="">Bipartite Graphs/Two-Mode Networks</a>. It is the degree centrality score!</p>
</section>
<section id="off-diagonal-cells" class="level4">
<h4 class="anchored" data-anchor-id="off-diagonal-cells">Off-Diagonal Cells</h4>
<p>The off-diagonal cells count the number of ways that separate nodes in <span class="math inline">\(N\)</span> are connected by nodes in <span class="math inline">\(M\)</span>. Using the language of “people” to refer to the <span class="math inline">\(N\)</span> node set, the off-diagonal represents the count of other people to whom a node in <span class="math inline">\(N\)</span> is connected.</p>
<p>For example, in the figure below, nodes <em>A</em> and <em>B</em> are linked through a single node, <em>1</em>. This means the value for the <span class="math inline">\(P_{A,B}\)</span> cell of the adjacency matrix <span class="math inline">\(P\)</span> (highlighted in green) is 1.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/ch-11-figure-11.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>Note that when we project, it forces the matrix to be <u>symmetric</u>. This means that the projection creates an <strong>undirected</strong> unipartite graph. As a result, the value for the <span class="math inline">\(P_{B,A}\)</span> cell of the adjacency matrix <span class="math inline">\(P\)</span> (also highlighted in green) is 1.</p>
<p>Let’s look at another example:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/ch-11-figure-12.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>Here, <em>A</em> and <em>C</em> are linked through two nodes in <span class="math inline">\(M\)</span>, <em>1</em> and <em>2</em>. This means that the value for the <span class="math inline">\(P_{A,C}\)</span> cell of the adjacency matrix <span class="math inline">\(P\)</span> (highlighted in green) is 2 and the value for the <span class="math inline">\(P_{C,A}\)</span> cell is also 2 (also highlighted in green). Using the language of “groups” to refer to the <span class="math inline">\(M\)</span> nodes, we can say that <em>A</em> and <em>C</em> are share membership in 2 groups.</p>
<p>Note, the off-diagonal cells represent counts of shared nodes in <span class="math inline">\(M\)</span>, <strong>not</strong> counts of edges. That is what the diagonal represents.</p>
</section>
</section>
<section id="group-matrix" class="level3">
<h3 class="anchored" data-anchor-id="group-matrix">“Group” Matrix</h3>
<p>To create the “group” matrix, <span class="math inline">\(G\)</span>, which connects nodes in the set <span class="math inline">\(M\)</span>, we perform the following matrix multiplication for our adjacency matrix <span class="math inline">\(A\)</span>:</p>
<p><span class="math display">\[A^T \times A = G\]</span> After multiplication we get:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/ch-11-figure-13.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>The product matrix has order <span class="math inline">\(M \times M\)</span> and shows us how groups are connected by people.</p>
<p>As with the product matrix <span class="math inline">\(P\)</span>, the values of the product matrix <span class="math inline">\(G\)</span> shows two important things:</p>
<ul>
<li>The diagonal cells represents the count of ties that a specific node in <span class="math inline">\(M\)</span> has with nodes in <span class="math inline">\(N\)</span></li>
<li>The off-diagonal cells count the number of ways that separate nodes in <span class="math inline">\(M\)</span> are connected by nodes in <span class="math inline">\(N\)</span></li>
</ul>
<p>Let’s take a look at each of these points.</p>
<section id="diagonal-cells-1" class="level4">
<h4 class="anchored" data-anchor-id="diagonal-cells-1">Diagonal Cells</h4>
<p>The diagonal tells us the count of ties that a specific node in <span class="math inline">\(M\)</span> has with nodes in <span class="math inline">\(N\)</span>. Using the language of “people” to refer to the <span class="math inline">\(N\)</span> node set, the diagonal is the count of people to which a node in <span class="math inline">\(M\)</span> is connected.</p>
<p>For example, in the figure below, <em>2</em> is in 3 groups:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/ch-11-figure-14.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>We can see this in the graph by counting the edges, but also by looking at the <span class="math inline">\(G_{2,2}\)</span> cell of the adjacency matrix <span class="math inline">\(G\)</span> (highlighted in red).</p>
<p>Here is a question. <em>What network measure does the diagonal give us?</em> Again, it is degree centrality!</p>
</section>
<section id="off-diagonal-cells-1" class="level4">
<h4 class="anchored" data-anchor-id="off-diagonal-cells-1">Off-Diagonal Cells</h4>
<p>The off-diagonal cells count the number of ways that separate nodes in <span class="math inline">\(M\)</span> are connected by nodes in <span class="math inline">\(N\)</span>. Using the language of “groups” to refer to the <span class="math inline">\(M\)</span> node set, the off-diagonal represents the count of other groups to whom a node in <span class="math inline">\(M\)</span> is connected.</p>
<p>For example, in the figure below, nodes <em>1</em> and <em>2</em> are linked through 2 nodes in <span class="math inline">\(M\)</span>, <em>A</em> and <em>C</em>. This means the value for the <span class="math inline">\(G_{2,1}\)</span> cell of the adjacency matrix <span class="math inline">\(G\)</span> (highlighted in green) is 2.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/ch-11-figure-15.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>Again, note that when we project it forces the matrix to be <u>symmetric</u>. This means that the projection creates an <strong>undirected</strong> unipartite graph. As a result, the value for the <span class="math inline">\(G_{1,2}\)</span> cell of the adjacency matrix <span class="math inline">\(G\)</span> (also highlighted in green) is 2.</p>
<p>Note that the off-diagonal cells represent counts of shared nodes in <span class="math inline">\(N\)</span>, <strong>not</strong> counts of edges. That is what the diagonal represents.</p>
</section>
</section>
</section>
<section id="dichotomization-and-summation" class="level2">
<h2 class="anchored" data-anchor-id="dichotomization-and-summation">Dichotomization and Summation</h2>
<p>Let’s return to our “people” matrix, which is a projected <span class="math inline">\(N \times N\)</span> network. Recall that the adjacency matrix looks like this:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/ch-11-figure-09.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>Now we are ready to use the tools we have employed in past chapters, right? Hold up. Note that some the off-diagonal cells are greater than 1. This is new territory for us. Now what?</p>
<section id="dichotomization" class="level3">
<h3 class="anchored" data-anchor-id="dichotomization">Dichotomization</h3>
<p>The most common solution is to define any tie greater than 0 in the adjacency matrix as a 1. That is, we would recode values greater than 1 to just be 1. Then, we recode the diagonal elements to be 0. That would then give us an adjacency matrix of 0s and 1s and we could go about our business as crime analysts. This is called <strong>dichotomizing</strong> the adjacency matrix and is the most common way of handling projections. The consequence is a <u>binary</u>, undirected, unipartite graph. What a mouthful!</p>
<p>For the people matrix <span class="math inline">\(P\)</span>, we can visualize this process here:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/ch-11-figure-16.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>However, note that we lose some information when we dichotomize the adjacency matrix. Specifically, we are treating connections that are greater than 1 as being the same as connections exactly equal to 1. This may make sense in some circumstances. For example, suppose you are only concerned with whether two individuals have ever been arrested together. In this case, the dichotomized matrix makes sense to examine.</p>
<p><em>But</em>, what if the number of co-arrests is really important? That is, relationships between individuals who have many co-arrests are fundamentally different than those who only have a single co-arrest. In this case, dichotomizing the adjacency matrix could misrepresent the data.</p>
</section>
<section id="summation" class="level3">
<h3 class="anchored" data-anchor-id="summation">Summation</h3>
<p>In situations where we want to preserve the information in the projection, we can retain the values in the adjacency matrix. When we do so, we are working with a <u>weighted</u>, undirected, unipartite graph. Here, the off-diagonal entries are tie <em>weights</em>. We can use this information in visualizations (such as shown in the case above for the study by <span class="citation" data-cites="young2015">Young and Ready (<a href="references.html#ref-young2015" role="doc-biblioref">2015</a>)</span>).</p>
<p>For example, consider the bipartite network below:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="snaca-projection_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>When we project, we can visualize the differences in the network based on whether we dichotomize the adjacency matrix (on the left) or maintain the weights (on the right).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="snaca-projection_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>We may be inclined to always keep the network weighted (i.e.&nbsp;not dichotomize the adjacency matrix), but there are far fewer tools for weighted networks. As you continue your work as a crime analyst, be sure to keep in mind what options you have for handling projections.</p>
<p><br></p>
</section>
</section>
<section id="test-your-knowledge" class="level2">
<h2 class="anchored" data-anchor-id="test-your-knowledge">Test your Knowledge</h2>
<ul>
<li>What are the two types of projections that can be created from a bipartite graph? Provide an example of each.</li>
<li>Define the term “transpose” of a matrix and explain its role in projecting networks.</li>
<li>What do the diagonal cells of a projected adjacency matrix represent? How about the off-diagonal cells?</li>
<li>In a projected graph, why are the off-diagonal values symmetric? What does this tell us about the resulting graph?</li>
<li>How would you interpret a high off-diagonal value in the adjacency matrix of a “people” matrix? What might it suggest in terms of real-world relationships?</li>
<li>What does dichotomization involve, and why might it be useful in network analysis?-</li>
<li>Give an example of a situation where it is more appropriate to use a weighted graph rather than a dichotomized graph.</li>
</ul>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>This chapter showed how to project bipartite networks into unipartite graphs. Projection is a useful technique for crime analysts to employ when they need to simplify complex relationships for analysis while retaining critical relational insights. By transforming two-mode data (e.g., individuals and groups) into one-mode networks, analysts can focus on relationships within a single node set, such as connections between co-offenders or shared affiliations between groups. We focused our attention also on the distinction between dichotomized and weighted projections, which allow analysts a way to tailor their approach based on whether binary connections or tie strengths are more relevant to the investigation. The tools and concepts presented, including adjacency matrices, matrix multiplication, and the implications of symmetric matrices, provide foundational methods for analyzing complex relational structures. For crime analysts, mastering these techniques enhances their ability to uncover patterns, predict interactions, and inform data-driven decision-making.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-breiger1974duality" class="csl-entry" role="listitem">
Breiger, Ronald L. 1974. <span>“The Duality of Persons and Groups.”</span> <em>Social Forces</em> 53 (2): 181–90. <a href="https://doi.org/10.1093/sf/53.2.181">https://doi.org/10.1093/sf/53.2.181</a>.
</div>
<div id="ref-young2015" class="csl-entry" role="listitem">
Young, Jacob T. N., and Justin T. Ready. 2015. <span>“Diffusion of Ideas and Technology: The Role of Networks in Influencing the Endorsement and Use of on-Officer Video Cameras.”</span> <em>Journal of Contemporary Criminal Justice</em> 31 (3): 243–61. <a href="https://doi.org/10.1177/1043986214553380">https://doi.org/10.1177/1043986214553380</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/jacobtnyoung\.github\.io\/snaca-textbook\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./snaca-bipartite.html" class="pagination-link" aria-label="Bipartite Graphs/Two-Mode Networks">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Bipartite Graphs/Two-Mode Networks</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link" aria-label="References">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Social Network Analysis for Crime Analysts was written by <a href="https://jacobtnyoung.github.io/">Jacob T.N. Young</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jacobtnyoung/snaca-textbook/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>